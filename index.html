<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Red Preview – Minimal URL Viewer</title>
  <meta name="description" content="A minimal, red-themed URL previewer that reads the ?url= query parameter and embeds the page when possible." />
  <style>
    :root{
      --red-50:#ffebee;
      --red-100:#ffcdd2;
      --red-200:#ef9a9a;
      --red-300:#e57373;
      --red-400:#ef5350;
      --red-500:#f44336;
      --red-600:#e53935;
      --red-700:#d32f2f;
      --red-800:#c62828;
      --red-900:#b71c1c;
      --bg:#121212;
      --surface:#1c1c1c;
      --text:#f8f8f8;
      --muted:#c7c7c7;
      --border:rgba(255,255,255,0.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,'Noto Sans',sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 100% -20%, var(--red-900) 0%, transparent 60%),
        radial-gradient(800px 800px at -10% 0%, var(--red-800) 0%, transparent 60%),
        linear-gradient(180deg, #080808, #141414 40%, #101010);
      min-height:100%;
    }
    a{color:var(--red-200); text-decoration:none}
    a:hover{text-decoration:underline}
    .header{
      padding:32px 16px 12px;
      text-align:center;
    }
    .title{
      display:inline-flex;
      align-items:center;
      gap:.5rem;
      font-size:1.25rem;
      letter-spacing:.02em;
      font-weight:700;
      color:white;
      background:linear-gradient(90deg, var(--red-200), white);
      -webkit-background-clip:text;
      background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    .brand-dot{
      width:10px;height:10px;border-radius:50%;
      background:var(--red-500);
      box-shadow:0 0 0 3px rgba(244,67,54,.25), 0 0 16px var(--red-500);
    }
    .container{max-width:980px; margin:0 auto; padding:0 16px 32px;}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border:1px solid var(--border);
      border-radius:14px;
      box-shadow:0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
      backdrop-filter: blur(4px);
    }
    .controls{
      display:flex; flex-wrap:wrap; gap:10px;
      padding:16px;
      border-bottom:1px solid var(--border);
    }
    .input{
      flex:1 1 360px;
      display:flex;
      border:1px solid var(--red-700);
      background:#0f0f0f;
      border-radius:10px;
      overflow:hidden;
      box-shadow:inset 0 0 0 1px rgba(229,57,53,.15);
    }
    .input input{
      padding:12px 12px;
      width:100%;
      border:0;
      outline:none;
      background:transparent;
      color:var(--text);
      font-size:16px;
    }
    .input input::placeholder{color:#aaaaaa}
    .btn{
      appearance:none;
      border:none;
      border-radius:10px;
      padding:12px 14px;
      font-weight:600;
      color:white;
      background:linear-gradient(180deg, var(--red-600), var(--red-700));
      box-shadow:0 6px 16px rgba(229,57,53,.35), inset 0 1px 0 rgba(255,255,255,.15);
      cursor:pointer;
      transition:transform .05s ease, filter .15s ease, box-shadow .15s ease, background .15s ease;
    }
    .btn:hover{filter:brightness(1.05)}
    .btn:active{transform:translateY(1px)}
    .btn.secondary{
      background:linear-gradient(180deg, #2a2a2a, #1f1f1f);
      color:#f2f2f2;
      box-shadow:0 6px 16px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
      border:1px solid var(--border);
    }
    .btn.ghost{
      background:transparent;
      color:var(--red-200);
      border:1px dashed rgba(229,57,53,.45);
      box-shadow:none;
    }
    .viewer{position:relative; height:68vh; min-height:360px;}
    .viewer iframe{
      width:100%; height:100%; border:0;
      border-bottom-left-radius:14px; border-bottom-right-radius:14px;
      background:#111;
    }
    .statusbar{
      display:flex; justify-content:space-between; align-items:center; gap:8px;
      color:var(--muted); font-size:.9rem; padding:10px 16px;
    }
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      font-size:.8rem; font-weight:700;
      color:#fff;
      background:linear-gradient(180deg, var(--red-700), var(--red-800));
      padding:6px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 6px 14px rgba(229,57,53,.35);
    }
    .help{opacity:.9}
    .error{color:#ffb4b4}
    .hidden{display:none !important}
    footer{
      padding:24px 16px 40px; text-align:center; color:#bbb; font-size:.9rem;
    }
    kbd{
      background:#222; border:1px solid var(--border); border-bottom-color:#000;
      border-radius:6px; padding:2px 6px;
      font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      color:#eee;
    }
    .visually-hidden{position:absolute!important; left:-9999px!important; top:auto!important; width:1px!important; height:1px!important; overflow:hidden!important}
  </style>
</head>
<body>
  <header class="header">
    <span class="title"><span class="brand-dot" aria-hidden="true"></span> Red Preview</span>
    <p class="help" style="margin:.5rem 0 0">Paste a link and press Enter to preview. Share with the ?url= query parameter.</p>
  </header>

  <main class="container">
    <section class="card" aria-label="URL previewer">
      <form id="form" class="controls" autocomplete="off" novalidate>
        <label class="visually-hidden" for="urlInput">URL to preview</label>
        <div class="input" style="flex:1">
          <input id="urlInput" name="url" type="url" inputmode="url" spellcheck="false" placeholder="https://example.com" aria-describedby="statusMsg" />
        </div>
        <button class="btn" id="viewBtn" type="submit" title="Preview URL">Preview</button>
        <button class="btn secondary" id="copyBtn" type="button" title="Copy shareable link">Copy Link</button>
        <button class="btn ghost" id="clearBtn" type="button" title="Clear URL">Clear</button>
      </form>

      <div class="statusbar" role="status" aria-live="polite">
        <div class="badge" id="badge"><span aria-hidden="true">●</span><span id="badgeText">Idle</span></div>
        <div id="statusMsg" class="help">Only websites that allow embedding will show below. You can always open in a new tab.</div>
      </div>

      <div class="viewer" id="viewerWrap">
        <iframe id="previewFrame" sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox allow-modals allow-pointer-lock allow-presentation" referrerpolicy="no-referrer"></iframe>
      </div>
      <div class="statusbar">
        <div class="help">If the site blocks embedding, use the link.</div>
        <div><a id="openLink" href="#" target="_blank" rel="noopener noreferrer">Open in new tab ↗</a></div>
      </div>
    </section>
  </main>

  <footer>
    Made with a red theme. Tip: Press <kbd>Enter</kbd> to preview.
  </footer>

  <script>
    (function(){
      const $ = (sel, ctx=document)=>ctx.querySelector(sel);
      const urlInput = $('#urlInput');
      const form = $('#form');
      const frame = $('#previewFrame');
      const openLink = $('#openLink');
      const statusMsg = $('#statusMsg');
      const badgeText = $('#badgeText');
      const copyBtn = $('#copyBtn');
      const clearBtn = $('#clearBtn');
      const viewBtn = $('#viewBtn');

      function setBadge(state){
        let text = 'Idle';
        switch(state){
          case 'loading': text = 'Loading'; break;
          case 'ok': text = 'Loaded'; break;
          case 'error': text = 'Error'; break;
          default: text = 'Ready';
        }
        badgeText.textContent = text;
      }

      function normalizeUrl(input){
        if(!input) return null;
        let raw = String(input).trim();
        if(!raw) return null;
        if(!/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(raw)){
          raw = 'https://' + raw;
        }
        try{
          const u = new URL(raw);
          if(u.protocol !== 'http:' && u.protocol !== 'https:') return null;
          return u.href;
        }catch(e){
          return null;
        }
      }

      function updateQueryParam(href){
        const url = new URL(window.location.href);
        if(href){
          url.searchParams.set('url', href);
        }else{
          url.searchParams.delete('url');
        }
        history.replaceState({}, '', url.toString());
      }

      function setStatus(message, isError=false){
        statusMsg.textContent = message;
        statusMsg.classList.toggle('error', !!isError);
      }

      function loadUrl(href){
        if(!href){
          frame.removeAttribute('src');
          openLink.href = '#';
          setBadge('ready');
          setStatus('Enter a URL to preview. Example: https://example.com');
          updateQueryParam('');
          return;
        }
        setBadge('loading');
        setStatus('Attempting to embed the site… Some sites block embedding for security.', false);
        openLink.href = href;
        updateQueryParam(href);

        let loaded = false;
        frame.onload = function(){
          loaded = true;
          setBadge('ok');
          setStatus('Embed loaded. If content appears blank, the site might block embedding; use the link instead.');
        };
        frame.src = href;

        setTimeout(()=>{
          if(!loaded){
            setBadge('error');
            setStatus('This site may block embedding in iframes. Use “Open in new tab” to view it.', true);
          }
        }, 3500);
      }

      function handleSubmit(e){
        e.preventDefault();
        const href = normalizeUrl(urlInput.value);
        if(!href){
          setBadge('error');
          setStatus('Please enter a valid http(s) URL.', true);
          return;
        }
        loadUrl(href);
      }

      copyBtn.addEventListener('click', async ()=>{
        const href = normalizeUrl(urlInput.value);
        if(!href){
          setStatus('Nothing to copy. Enter a valid URL first.', true);
          return;
        }
        const share = new URL(window.location.href);
        share.searchParams.set('url', href);
        const text = share.toString();
        try{
          await navigator.clipboard.writeText(text);
          setStatus('Shareable link copied to clipboard.');
        }catch(err){
          const ta = document.createElement('textarea');
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try{
            document.execCommand('copy');
            setStatus('Shareable link copied to clipboard.');
          }catch(e){
            setStatus('Copy failed. You can manually copy from the address bar.', true);
          }finally{
            ta.remove();
          }
        }
      });

      clearBtn.addEventListener('click', ()=>{
        urlInput.value = '';
        frame.removeAttribute('src');
        openLink.href = '#';
        updateQueryParam('');
        setBadge('ready');
        setStatus('Cleared. Enter a URL to preview.');
        urlInput.focus();
      });

      form.addEventListener('submit', handleSubmit);

      // Initialize from ?url=
      const initial = new URL(window.location.href).searchParams.get('url');
      if(initial){
        const href = normalizeUrl(initial);
        if(href){
          urlInput.value = href;
          updateQueryParam(href);
          loadUrl(href);
        }else{
          setStatus('The provided ?url parameter is invalid.', true);
        }
      }else{
        setStatus('Enter a URL to preview. Example: https://example.com');
      }

      // Submit on Enter for some mobile browsers
      urlInput.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter'){
          e.preventDefault();
          viewBtn.click();
        }
      });
    })();
  </script>
</body>
</html>